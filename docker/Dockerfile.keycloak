# Keycloak Docker image with realm configuration
FROM quay.io/keycloak/keycloak:23.0

# Copy realm configuration
COPY keycloak/realm-export.json /opt/keycloak/data/import/realm-export.json

# Set environment for import
ENV KC_HEALTH_ENABLED=true
ENV KC_METRICS_ENABLED=true

# Build optimized Keycloak
RUN /opt/keycloak/bin/kc.sh build

ENTRYPOINT ["/opt/keycloak/bin/kc.sh"]
